---
title: ApiHug Spring Security Extension
description: ApiHug SDK spring security extension
---

import { TipInfo } from '@/components/Tip'

å®‰å…¨æ¡†æ¶æ˜¯ä¸€ä¸ªæä¾›èº«ä»½éªŒè¯ï¼ˆauthenticationï¼‰ã€æˆæƒï¼ˆauthorizationï¼‰å’Œé˜²æ­¢å¸¸è§æ”»å‡»çš„æ¡†æ¶ã€‚

<TipInfo>ï¸ï¸âš ï¸ Apihug Security ä¸ Spring Security åœ¨è¿è¡Œæ—¶ä¸å…¼å®¹ï¼Œä¸å»ºè®®åœ¨è¿è¡Œæ—¶å…±å­˜ã€‚</TipInfo>

**ApiHug** æä¾›äº†ä¸€ä¸ªæç®€åˆå‡‘æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œæœ‰åˆ«äºä¼ ç»Ÿ Apache Shiro, æˆ–è€… Spring Securityã€‚

åº•å±‚ä¾ç„¶æ˜¯åŸºäºèµ„æº(Resource ä¹Ÿå°±æ˜¯API)æƒé™ç®¡ç†ï¼›å¦‚é›†åˆè§’è‰²ï¼Œå°±æ˜¯ä¸€ä¸ªæç®€RBACæ¶æ„,å¼€ç®±å³ç”¨ã€‚

## åè®®

Proto å±‚å¦‚ä½•å®šä¹‰åè®® [æç®€ Authentication & Authorization](/zhCN-docs/framework/widget/authority)

## å®ç°

1. SecurityAspect  åˆ‡é¢ Aspect
2. SecurityContext: è¿è¡Œæ—¶å€™ security context, åŒ…æ‹¬èµ„æº åˆ° CheckerAuthorization æ˜ å°„
3. HopeSecurityManager è¿è¡Œæ—¶ security å‚æ•°ç»„è£…
4. JWTFilter jwt filter è¿‡æ»¤

ç›®å‰**Aspect** SecurityAspect åˆ‡é¢åªæ”¯æŒ **BEFORE** ä¹Ÿå°±æ˜¯è¿›å…¥èµ„æº(API)ä¸šåŠ¡é€»è¾‘å‰æ ¡éªŒã€‚

### é…ç½®

é…ç½®è·¯å¾„ `hope.security`ï¼› é…ç½®å¯¹è±¡ `HopeSecurityProperties`ã€‚

| é…ç½®                                        | å¤‡æ³¨                       |
|-------------------------------------------|--------------------------|
| `enabled`                                 | æ˜¯å¦å¯ç”¨ ApiHug Security.    |
| `jwt`                                     | JWT é…ç½®.                  |
| `jwt.base64Secret`                        | Base64 secret.           |
| `jwt.secret`                              | secret.                  |
| `jwt.tokenValidityInSecondsForRememberMe` | Remember me æ—¶å€™æœ‰æ•ˆæœŸï¼Œé»˜è®¤30å¤©. |
| `jwt.tokenValidityInSeconds`              | é»˜è®¤æœ‰æ•ˆæ—¶é—´ï¼Œ7å¤©.               |


## ç¦ç”¨ Spring Security

<TipInfo>âš ï¸ Apihug Security ä¸ Spring Security åœ¨è¿è¡Œæ—¶ä¸å…¼å®¹ã€‚</TipInfo>

ç¦ç”¨ Spring Security æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä»é¡¹ç›®ä¸­ç§»é™¤å…¶ **ä¾èµ–é¡¹**ã€‚

é€šè¿‡ç§»é™¤ä»¥ä¸‹ä¾èµ–ï¼Œå¯ä»¥æ¸…é™¤é¡¹ç›®ä¸­æ‰€æœ‰ç”± Spring Security æä¾›çš„å®‰å…¨é…ç½®å’Œé»˜è®¤è®¾ç½®ï¼š

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-security</artifactId>
    <version>...</version>
</dependency>
```

ç§»é™¤è¯¥ä¾èµ–åï¼Œåº”ç”¨ç¨‹åºä¸­å°†ä¸å†åŒ…å«ä»»ä½• Spring Security çš„åŠŸèƒ½ã€‚

ä½†å¦‚æœæ‚¨ä»å¸Œæœ›ä½¿ç”¨éƒ¨åˆ† Spring Security çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨æ‰‹åŠ¨ç¦ç”¨å…¶è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼š

**æ’é™¤ Spring Security è‡ªåŠ¨é…ç½®**

å½“é¡¹ç›®ç±»è·¯å¾„ä¸­åŒ…å« `spring-boot-starter-security` æ—¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨å¯ç”¨å®‰å…¨é…ç½®ã€‚è‹¥è¦ç¦ç”¨è¯¥è‡ªåŠ¨é…ç½®ï¼Œå¯åœ¨ `application.properties` æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š

```properties
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration
```

å¦‚æœæ‚¨å¸Œæœ›å®Œå…¨ç¦ç”¨ Spring Securityï¼Œå»ºè®®ä»…é€šè¿‡ `spring.autoconfigure.exclude` é…ç½®å®ç°ï¼Œè€Œä¸è¦åˆ›å»º `SecurityConfiguration` ç±»ã€‚

è¯·æ³¨æ„ï¼šæ‰‹åŠ¨å®šä¹‰ Spring Security é…ç½®ç±»ä¼šè¦†ç›– `application.properties` ä¸­çš„é…ç½®ï¼Œå› æ­¤å½“ä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œ`application.properties` ä¸­çš„æ’é™¤é…ç½®å°†å¤±æ•ˆã€‚


<TipInfo>To be done ğŸ—ï¸</TipInfo>

## Refer

1. [æç®€ Authentication & Authorization](/zhCN-docs/framework/widget/authority)
2. [Spring Security](https://docs.spring.io/spring-security/reference/index.html)
3. [Apache Shiro](https://shiro.apache.org/)
4. [RBAC - Role-based access control](https://en.wikipedia.org/wiki/Role-based_access_control)
