---
title: ApiHug MCP Support
description: how the Apihug support MCP,
---

æ”¯æŒä¼ä¸šçº§ MCPï¼Œå……åˆ†åˆ©ç”¨ç°æœ‰åŸºç¡€è®¾æ–½å’Œæˆæƒä¿æŠ¤ã€‚

è‡ª SDK ç‰ˆæœ¬ `1.4.0-RELEASE` åŠ IDEA æ’ä»¶ `0.7.5` èµ·ï¼Œæ”¯æŒåˆå§‹åŒ–é¡¹ç›®æ¨¡æ¿çš„ç”Ÿæˆã€‚

**ä»…** å¯¹ MCP æœåŠ¡ç«¯è¿›è¡Œå¢å¼ºã€‚

## æœ€æ–°ç‰ˆæœ¬

<a target="_blank" href="https://search.maven.org/artifact/com.apihug/it-bom">
  <img src="https://img.shields.io/maven-central/v/com.apihug/it-bom.svg?label=Maven%20Central"/>
</a>

<div>
  <iframe
    src="https://plugins.jetbrains.com/embeddable/card/23534"
    border="0"
    height={'319px'}
    width={'384px'}
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowFullScreen
  ></iframe>
</div>

## æ¦‚è¿°

[æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰](https://modelcontextprotocol.org/docs/concepts/architecture) æ˜¯ä¸€ç§æ ‡å‡†åŒ–åè®®ï¼Œä½¿ AI æ¨¡å‹èƒ½å¤Ÿä»¥ç»“æ„åŒ–æ–¹å¼ä¸å¤–éƒ¨å·¥å…·å’Œèµ„æºäº¤äº’ã€‚å®ƒæ”¯æŒå¤šç§ä¼ è¾“æœºåˆ¶ï¼Œä»¥ç¡®ä¿åœ¨ä¸åŒç¯å¢ƒä¸­å…·å¤‡è‰¯å¥½çš„çµæ´»æ€§ã€‚

è¯·æ³¨æ„ï¼Œç›®å‰ MCP ä»å¤„äºå¿«é€Ÿå¼€å‘é˜¶æ®µï¼Œå…¶æ¦‚å¿µå’Œ API å¯èƒ½ä¼šå‘ç”Ÿé‡å¤§å˜åŒ–ï¼Œä¸”æ— æ³•ä¿è¯å‘åå…¼å®¹æ€§ã€‚

ç”±äºè¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§åŠŸèƒ½ï¼Œé¡»æ‰‹åŠ¨å¯ç”¨!

å½“å‰çš„ MCP å°šæœªæ»¡è¶³ä¼ä¸šçº§è¦æ±‚ï¼Œä¾‹å¦‚ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶ï¼Œå³ä½¿åœ¨ MCP Java SDK `0.8.0` å¼•å…¥ç ´åæ€§å˜æ›´ä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ âš ï¸ã€‚ä¸ºæ­¤ï¼ŒApiHug æä¾›äº†å…³é”®å¢å¼ºåŠŸèƒ½ï¼š

1. **ä¼ä¸šçº§å®‰å…¨æ€§**ï¼šå®Œæ•´çš„è®¿é—®æ§åˆ¶æœºåˆ¶ï¼Œä¸ç°æœ‰ä¼ä¸šæ¶æ„ä¿æŒä¸€è‡´ã€‚
2. **æœ€å°åŒ–é›†æˆå½±å“**ï¼šå¤ç”¨ç°æœ‰åŸºç¡€è®¾æ–½å’Œæ ‡å‡†ï¼Œå¯¹ç³»ç»Ÿæ”¹åŠ¨æå°ã€‚

![MCP å †æ ˆå›¾](https://docs.spring.io/spring-ai/reference/_images/mcp/mcp-stack.svg)

åŸºäº Spring AIï¼ŒApiHug å¼•å…¥äº†ä»¥ä¸‹å¢å¼ºåŠŸèƒ½ï¼š

1. **è‡ªå®šä¹‰åè®®å±‚**ï¼šæ— ç¼æ³¨å…¥è‡ªå®šä¹‰æˆæƒå’Œä¼šè¯ç®¡ç†ã€‚
2. **é€‚é…å±‚**ï¼šè¿æ¥ç°æœ‰åç«¯æœåŠ¡ä¸ MCP æ ‡å‡†ï¼Œä¸å½±å“åŸæœ‰é€»è¾‘ã€‚
3. **ç»Ÿä¸€èµ„æºæ§åˆ¶**ï¼šåº”ç”¨ä¸€è‡´çš„éªŒè¯å’Œæˆæƒæœºåˆ¶ã€‚
4. **ç»†ç²’åº¦æš´éœ²æ§åˆ¶**ï¼šç²¾ç¡®æ§åˆ¶å“ªäº›èµ„æºé€šè¿‡ MCP æš´éœ²ï¼Œç»†åŒ–åˆ°æ¯ä¸ª APIã€‚

## è¿ç§»æŒ‡å—

### `libs.versions.toml`

1. å°† `apihugVersion` å‡çº§è‡³ `1.4.0-RELEASE` æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2. å°† `springAiVersion` å‡çº§è‡³ `1.0.0` æˆ–æ›´é«˜ç‰ˆæœ¬ï¼›å¦‚æ— ï¼Œè¯·æ·»åŠ ã€‚
3. æ·»åŠ ä»¥ä¸‹ä¾èµ–åº“ï¼š
   - `apihug-spring-ai-mcp = { group = "com.apihug", name = "it-common-spring-ai-mcp" }`
   - `spring-ai-bom = { group = "org.springframework.ai", name = "spring-ai-bom", version.ref = "springAiVersion" }`
   - `spring-ai-starter-mcp-server = { group = "org.springframework.ai", name = "spring-ai-starter-mcp-server" }`

### `app` æ¨¡å—

1. å¯ç”¨ `hopeStub`ï¼šè®¾ç½® `enableMcp = true`
2. æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š

```groovy
// ç”¨äº MCP â€” å½“å‰ç‰ˆæœ¬æ­£åœ¨è¯„å®¡ä¸­
implementation(libs.apihug.spring.ai.mcp)
implementation platform(libs.spring.ai.bom)
implementation(libs.spring.ai.starter.mcp.server)
```

### æœåŠ¡åŠ è½½å™¨

è¦æ‰©å±• `hope.common.service.contract.ContractAdapter`ï¼Œéœ€æŒ‡å®šä»¥ä¸‹å†…å®¹ï¼š

1. `moduleClassName`ï¼šè¿è¡Œæ—¶ proto æ¨¡å—çš„ç±»åï¼ˆè‡ªåŒ…å«ï¼‰ã€‚
2. `mcp`ï¼šæ§åˆ¶ MCP æœåŠ¡çš„æš´éœ²æ–¹å¼ â€” æŒ‡å®šå“ªä¸ªæœåŠ¡æš´éœ²å“ªäº›æ–¹æ³•ï¼ˆAPIï¼‰ã€‚
3. `contract`ï¼šå®šä¹‰ç¬¬ä¸‰æ–¹æ¨¡å—ä¾èµ– â€” å“ªä¸ªæœåŠ¡ä¾èµ–äºå“ªäº›æ–¹æ³•ï¼ˆAPIï¼‰ã€‚

æœåŠ¡è¿‡æ»¤DSL:

```java
  return myModule.service()
          .apiContext()
          .orderService(
              svc -> {
                // Keep all the methods of this service
                svc.keepAll();
                // All the method start with, feel free try other shortcut
                svc.startsWith("add");
                // Pick method one by one
                svc.methods(
                    methods -> {
                      // Include this method
                      methods.PlaceOrder();
                      // Exclude this method, start with `_`
                      methods._DeleteOrder();
                    });
              })
          .build();
```

### Spring Server AI é…ç½®

è¯·å‚è€ƒå®˜æ–¹ [MCP Server Boot Starter æ–‡æ¡£](https://docs.spring.io/spring-ai/reference/api/mcp/mcp-server-boot-starter-docs.html)ï¼Œå¯ç”¨ MCP æœåŠ¡ã€‚

```yaml
spring:
  ai:
    mcp:
      server:
        enabled: true
        # default /sse
        sse-endpoint: /api/mcp/sse
        # default /mcp/message
        sse-message-endpoint: /api/mcp/message
        name: okai-app-mcp-server
        stdio: false
hope:
  ai:
    mcp:
      enabled: true
      auth-key: token
```

æœ‰å…³ `spring.ai.mcp.server` çš„é…ç½®è¯¦æƒ…ï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š  
**[MCP Server Boot Starter - é…ç½®å±æ€§](https://docs.spring.io/spring-ai/reference/api/mcp/mcp-server-boot-starter-docs.html#_configuration_properties)**ã€‚

**æç¤ºï¼š** è¯·ç¡®ä¿å°† SSE ç«¯ç‚¹å’Œæ¶ˆæ¯ç«¯ç‚¹çš„è·¯å¾„è®¾ç½®ä¸ºç¬¦åˆä½ å›¢é˜Ÿæœ€ä½³å®è·µæ ‡å‡†çš„æ ¼å¼ã€‚

ä»¥ä¸‹ä¸¤ä¸ªè·¯ç”±å°†è¢«å¼•å…¥ï¼š

1. `GET` `/api/mcp/sse`
2. `POST` `/api/mcp/message`

å¦‚éœ€äº†è§£å¦‚ä½•åœ¨æœ¬åœ°è¿›è¡Œ MCP æµ‹è¯•ï¼Œè¯·å‚è€ƒ Spring å®˜æ–¹ç¤ºä¾‹ï¼š  
**[spring-ai-examples - æµ‹è¯• - ClientSse](https://github.com/spring-projects/spring-ai-examples/blob/main/model-context-protocol/weather/starter-webmvc-server/src/test/java/org/springframework/ai/mcp/sample/client/ClientSse.java)**ã€‚

ä¸€åˆ‡å·²å‡†å¤‡å°±ç»ªï¼ç¥ä½ å¼€å‘é¡ºåˆ©ï¼Œå¤§å¿«æœµé¢ï¼ğŸ€

## æ–°æ¨¡æ¿

å°†æ‚¨çš„ IDEA æ’ä»¶å‡çº§è‡³ `0.7.5` æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚æ–°ç”Ÿæˆçš„é¡¹ç›®å°†è‡ªåŠ¨åŒ…å«æ‰€æœ‰å¿…è¦çš„é…ç½®ï¼Œæ— éœ€åƒæ—§é¡¹ç›®é‚£æ ·è¿›è¡Œæ‰‹åŠ¨è¿ç§»ã€‚

## ç¤ºä¾‹

TBD


## Refer

1. [MCP Server Boot Starter](https://docs.spring.io/spring-ai/reference/api/mcp/mcp-server-boot-starter-docs.html)
2. [Model Context Protocol ](https://modelcontextprotocol.org/docs/concepts/architecture)
3. [MCP Java SDK](https://modelcontextprotocol.io/sdk/java)
